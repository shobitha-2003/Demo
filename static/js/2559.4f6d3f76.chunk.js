"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[2559],{1163:(e,t,n)=>{n(2382),n(579)},2559:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var a=n(5043),s=n(6165),i=n(7458),l=(n(1163),n(2784)),o=n(9981),c=n(579);const r=()=>(0,c.jsxs)("section",{className:"breadcrumb breadcrumb-four padding-static-y-60 section-bg position-relative z-index-1 overflow-hidden",children:[(0,c.jsx)("img",{src:"/assets/images/gradients/Bg2.webp",alt:"",className:"bg--gradient"}),(0,c.jsx)("div",{className:"container container-two",children:(0,c.jsx)("div",{className:"row justify-content-center",children:(0,c.jsx)("div",{className:"col-lg-12",children:(0,c.jsxs)("div",{className:"breadcrumb-four-content",children:[(0,c.jsx)("h3",{className:"breadcrumb-four-content__title text-center mb-3 text-capitalize",children:"Appointment Cart"}),(0,c.jsxs)("ul",{className:"breadcrumb-list flx-align justify-content-center gap-2 mb-2",children:[(0,c.jsx)("li",{className:"breadcrumb-list__item font-14 text-body",children:(0,c.jsx)(o.N_,{to:"/",className:"breadcrumb-list__link text-body hover-text-main",children:"Home"})}),(0,c.jsx)("li",{className:"breadcrumb-list__item font-14 text-body",children:(0,c.jsx)("span",{className:"breadcrumb-list__icon font-10",children:(0,c.jsx)("i",{className:"fas fa-chevron-right"})})}),(0,c.jsx)("li",{className:"breadcrumb-list__item font-14 text-body",children:(0,c.jsx)("span",{className:"breadcrumb-list__text",children:"Appointment Cart"})})]})]})})})})]});var d=n(9379),m=n(1100),u=n(9722),v=n(6178),p=n.n(v),h=n(8e3);const x=()=>{var e;const{cartItems:t,removeFromCart:n}=(0,m._)(),[s,i]=(0,a.useState)({}),l=(0,o.Zp)(),r=(null===(e=(0,o.zy)().state)||void 0===e?void 0:e.from)||"/";(0,a.useEffect)(()=>{const e=localStorage.getItem("appointmentDetails");e&&i(JSON.parse(e))},[]),(0,a.useEffect)(()=>{localStorage.setItem("appointmentDetails",JSON.stringify(s))},[s]);const v=(e,t)=>{i(n=>(0,d.A)((0,d.A)({},n),{},{[e]:(0,d.A)((0,d.A)({},n[e]),{},{date:t,time:""})}))};(0,a.useEffect)(()=>{const e=()=>{localStorage.removeItem("appointmentDetails")};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[]);const x=(e,t)=>{var n;null===(n=s[e])||void 0===n||n.date;i(n=>(0,d.A)((0,d.A)({},n),{},{[e]:(0,d.A)((0,d.A)({},n[e]||{}),{},{time:t})}))},[f,g]=(0,a.useState)({}),j=async(e,t)=>{if(e&&t)try{var n,a,s,i;let l="";if("service"===t)l="".concat("https://api.4ceps.com","/api/centreService/single/").concat(e);else{if("package"!==t)return void console.error("Invalid type:",t);l="".concat("https://api.4ceps.com","/api/packages/single/").concat(e)}const o=await u.A.get(l),c="service"===t?null===(n=o.data)||void 0===n||null===(a=n.service)||void 0===a?void 0:a.slots:null===(s=o.data)||void 0===s||null===(i=s.package)||void 0===i?void 0:i.slots;return g(t=>(0,d.A)((0,d.A)({},t),{},{[e]:c||[]})),o.data}catch(l){console.error("Error fetching item from cart:",l)}else console.error("Missing id or type")};function b(e){if(e.toUpperCase().includes("AM")||e.toUpperCase().includes("PM"))return e.replace(/\s+/g,"");const[t,n]=e.split(":");let a=parseInt(t,10);const s=a>=12?"PM":"AM";return a=a%12||12,"".concat(a,":").concat(n).concat(s)}(0,a.useEffect)(()=>{t.forEach(e=>{var t,n;const a="service"===e.type?null===(t=e.service)||void 0===t?void 0:t._id:null===(n=e.package)||void 0===n?void 0:n._id;a&&j(a,e.type)})},[t]);const N=e=>e.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");return(0,c.jsx)("div",{className:"cart padding-y-120",children:(0,c.jsx)("div",{className:"container",children:(0,c.jsxs)("div",{className:"cart-content",style:{marginTop:"-80px"},children:[(0,c.jsxs)("div",{className:"table-responsive",children:[(0,c.jsx)("p",{style:{textAlign:"center",paddingBottom:"40px"},children:"Please choose a time slot at least 2 hours from now."}),(0,c.jsxs)("table",{className:"table style-two",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:"Service Details"}),(0,c.jsx)("th",{children:"Appointment Date"}),(0,c.jsx)("th",{children:"Appointment Time"}),(0,c.jsx)("th",{children:"Service Cost(\u20b9)"})]})}),(0,c.jsx)("tbody",{children:0===t.length?(0,c.jsx)("tr",{children:(0,c.jsx)("td",{colSpan:"4",className:"text-center text-muted py-4",children:"No booking has been done."})}):t.map((e,t)=>{var a,l,r,m,u,g,y;const _="service"===e.type,k=(e.type,_?e.service:e.package),w=null===k||void 0===k?void 0:k._id,A=null===(a=s[w])||void 0===a?void 0:a.date,S=A?new Date(A).toLocaleDateString("en-US",{weekday:"long"}):null;const C=f[w]||[];let D=S?C.filter(e=>e.day.trim().toLowerCase()===S.toLowerCase()):[];D=D.filter(e=>function(e,t){if(!t)return!0;let n="";if("string"===typeof e)n=e.split("-")[0];else{if(!e.from)return!0;n=e.from}const a=p()("".concat(t," ").concat(n),"YYYY-MM-DD hh:mm A");return!p()(t,"YYYY-MM-DD").isSame(p()(),"day")||a.isAfter(p()().add(2,"hours"))}(e,A)),D.sort((e,t)=>p()(e.from,"hh:mm A")-p()(t.from,"hh:mm A"));const E=A&&0===D.length;return(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:(0,c.jsxs)("div",{className:"cart-item",children:[(0,c.jsx)("div",{className:"d-flex align-items-center gap-3",children:(0,c.jsxs)("div",{className:"cart-item__content",children:[(0,c.jsx)("h6",{className:"cart-item__title font-heading fw-700 text-capitalize font-18 mb-4",children:_?(0,c.jsx)(o.N_,{to:"/service-details/".concat(null===k||void 0===k?void 0:k._id),className:"link",children:N(null===k||void 0===k?void 0:k.serviceName)}):(0,c.jsx)(o.N_,{to:"/package-details/".concat(null===k||void 0===k?void 0:k._id),className:"link",children:N(null===k||void 0===k?void 0:k.packageName)})}),_&&(0,c.jsx)("p",{className:"text-muted font-14 mb-2",children:N(null===k||void 0===k?void 0:k.serviceCategory)}),(0,c.jsxs)("span",{className:"cart-item__price font-18 text-heading fw-500",style:{marginTop:"-5px"},children:[(0,c.jsx)("span",{className:"text-body font-14",children:N(null===k||void 0===k||null===(l=k.centre)||void 0===l?void 0:l.centreName)}),(0,c.jsx)("br",{}),(0,c.jsx)("span",{className:"text-body font-14",children:null===k||void 0===k||null===(r=k.doctors)||void 0===r||null===(m=r[0])||void 0===m?void 0:m.name})]})]})}),(0,c.jsx)("div",{className:"flx-align gap-4 mt-3 mt-lg-4",children:(0,c.jsx)("button",{type:"button",className:"btn btn-sm btn-danger",onClick:()=>(e=>{var t,a;const l="service"===(null===e||void 0===e?void 0:e.type)?null===e||void 0===e||null===(t=e.service)||void 0===t?void 0:t._id:null===e||void 0===e||null===(a=e.package)||void 0===a?void 0:a._id;n(l,null===e||void 0===e?void 0:e.type);const o=(0,d.A)({},s);delete o[l],i(o)})(e),children:"Remove"})})]})}),_?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("td",{children:(0,c.jsx)("input",{type:"date",className:"common-input radius-8 common-input--md",min:(0,h.ak)(),value:A||"",onChange:e=>{const t=e.target.value;if(!(0,h.En)(t))return e.target.value=(0,h.ak)(),void alert("Please select a valid date (today or future).");v(w,t)},onBlur:e=>{(0,h.En)(e.target.value)||(e.target.value=(0,h.ak)())},required:!0})}),(0,c.jsxs)("td",{children:[(0,c.jsx)("div",{className:"select-has-icon",children:(0,c.jsxs)("select",{className:"common-input border",value:(null===(u=s[w])||void 0===u?void 0:u.time)||"",onChange:e=>x(w,e.target.value),onClick:()=>j(w,e.type),disabled:E,children:[(0,c.jsx)("option",{value:"",children:"Select Slot"}),D.map((e,t)=>{const n="".concat(e.from," - ").concat(e.to);return(0,c.jsx)("option",{value:n,children:n},t)})]})}),E&&(0,c.jsx)("p",{className:"text-danger",style:{fontSize:"0.875rem"},children:"No appointment slots available on this day."})]})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("td",{children:(0,c.jsx)("input",{type:"date",className:"common-input radius-8 common-input--md",value:(null===(g=s[w])||void 0===g?void 0:g.date)||"",min:(0,h.ak)(),onChange:e=>{const t=e.target.value;if(!(0,h.En)(t))return e.target.value=(0,h.ak)(),void alert("Please select a valid date (today or future).");v(w,t)},onBlur:e=>{(0,h.En)(e.target.value)||(e.target.value=(0,h.ak)())},required:!0})}),(0,c.jsxs)("td",{children:[(0,c.jsx)("div",{className:"select-has-icon",children:(0,c.jsxs)("select",{className:"common-input border",value:(null===(y=s[w])||void 0===y?void 0:y.time)||"",onChange:e=>x(w,e.target.value),onClick:()=>j(e._id,e.type),disabled:E,required:!0,children:[(0,c.jsx)("option",{value:"",children:"Select Slot"}),D.map((e,t)=>{const n=function(e){if("string"===typeof e){const[t,n]=e.split("-");return"".concat(b(t),"-").concat(b(n))}return null!==e&&void 0!==e&&e.from&&null!==e&&void 0!==e&&e.to?"".concat(b(e.from),"-").concat(b(e.to)):String(e)}(e);return(0,c.jsx)("option",{value:n,children:n},t)})]})}),E&&(0,c.jsx)("p",{className:"text-danger",style:{fontSize:"0.875rem"},children:"No appointment slots available on this day."})]})]}),(0,c.jsx)("td",{style:{textAlign:"center"},children:(0,c.jsxs)("span",{className:"cart-item__totalPrice text-body font-18 fw-400 mb-0",children:[" ","\u20b9",null===k||void 0===k?void 0:k.totalPrice]})})]},e._id||t)})})]})]}),(0,c.jsxs)("div",{className:"cart-content__bottom flx-between gap-2",children:[(0,c.jsxs)(o.N_,{to:r,className:"btn btn-outline-light flx-align gap-2 pill btn-lg",children:[(0,c.jsx)("span",{className:"icon line-height-1 font-20",children:(0,c.jsx)("i",{className:"fas fa-arrow-left"})}),"Book Other Service"]}),(0,c.jsxs)("button",{className:"btn btn-main flx-align gap-2 pill btn-lg",onClick:()=>{if(0===t.length)return void alert("Please select at least one booking to proceed forward");let e=!0;if(t.forEach(t=>{var n,a;const i="service"===t.type?null===(n=t.service)||void 0===n?void 0:n._id:null===(a=t.package)||void 0===a?void 0:a._id,l=s[i]||{};l.date&&l.time||(e=!1)}),!e)return void alert("Please select both date and time for all items before proceeding.");const n=localStorage.getItem("token");l(n?"/cart-personal":"/user-login")},children:["Next",(0,c.jsx)("span",{className:"icon line-height-1 font-20",children:(0,c.jsx)("i",{className:"fas fa-arrow-right"})})]})]})]})})})},f=()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.A,{}),(0,c.jsx)(i.A,{}),(0,c.jsx)(r,{}),(0,c.jsx)(x,{}),(0,c.jsx)(l.A,{})]})},8e3:(e,t,n)=>{n.d(t,{En:()=>i,ak:()=>s,fF:()=>a});const a=e=>{const t=(new Date-new Date(e))/1e3,n=[{name:"year",seconds:31536e3},{name:"month",seconds:2592e3},{name:"day",seconds:86400},{name:"hour",seconds:3600},{name:"minute",seconds:60},{name:"second",seconds:1}];for(let a of n){const e=Math.floor(t/a.seconds);if(e>=1)return new Intl.RelativeTimeFormat("en",{numeric:"auto"}).format(-e,a.name)}return"just now"};function s(){const e=new Date;e.setHours(0,0,0,0);const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(a)}function i(e){const t=new Date(e),n=new Date;return n.setHours(0,0,0,0),t>=n}}}]);
//# sourceMappingURL=2559.4f6d3f76.chunk.js.map